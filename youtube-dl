#!/bin/bash

set -e -f -u -o pipefail

main() {
  if [[ "$#" -eq 0 ]]; then
    printf "USAGE: %s URL [URLS]\\n" "$0" >&2
    exit 1
  fi

  brew update
  brew upgrade
  brew cleanup
  until /usr/local/bin/youtube-dl "$@"; do
    sleep 10
  done
}

main "$@"
